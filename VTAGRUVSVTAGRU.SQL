 SELECT  GRU_CODIGO, GRU_DESCRI,SUM(GRU_CANTID) AS VALDESDE, 
 ( SELECT SUM(GRU_CANTID) FROM view_dpgrupo_vta AS T2 
  WHERE  T1.GRU_CODIGO=T2.GRU_CODIGO AND (T2.GRU_FECHA>='2023-05-01' AND T2.GRU_FECHA<='2023-05-31') ) AS VALHASTA, 
  IF (( SELECT SUM(GRU_CANTID) FROM view_dpgrupo_vta AS T2 
  WHERE  T1.GRU_CODIGO=T2.GRU_CODIGO AND T2.GRU_FECHA>="2023-04-01" AND T2.GRU_FECHA<="2023-07-31") IS NULL,SUM(GRU_CANTID), 
 ( SELECT SUM(GRU_CANTID) FROM view_dpgrupo_vta AS T2 
  WHERE  T1.GRU_CODIGO=T2.GRU_CODIGO AND T2.GRU_FECHA>="2023-04-01" AND T2.GRU_FECHA<="2023-07-31")) AS DIF 
 FROM view_dpgrupo_vta AS T1 
 WHERE (T1.GRU_FECHA>='2023-06-01' AND T1.GRU_FECHA<='2023-06-30')
 GROUP BY GRU_CODIGO
 ORDER BY GRU_CANTID DESC 